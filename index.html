 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MASOLITES ECOMAS</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    <style>
        /* ALL STYLES FROM PREVIOUS VERSION */
        :root {
            --deep-blue: #0a2463;
            --navy: #1a1a2e;
            --light-blue: #3e92cc;
            --lemon-green: #a4de02;
            --accent: #d8315b;
            --card-bg: rgba(26, 26, 46, 0.8);
            --text-light: #ffffff;
            --mining-off: #ff9500;
            --mining-on: #4cd964;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: var(--text-light);
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            padding: 15px;
            overflow: hidden;
        }
        
        .app-container {
            max-width: 500px;
            margin: 0 auto;
            height: 100vh;
            overflow-y: auto;
            padding-bottom: 20px;
        }
        
        /* ... (ALL OTHER STYLES REMAIN UNCHANGED) ... */
    </style>
</head>
<body>
    <!-- ENTIRE APPLICATION STRUCTURE (UNCHANGED) -->
    
    <script>
        // Tokenomics Configuration
        const TOKENOMICS = {
            totalSupply: 50000000,
            privateSale: 25000000,
            currentPrice: 0.001,
            ngnPrice: 18
        };

        // User Management
        class UserSystem {
            static register(email, password, referralCode = null) {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                
                if (users.find(u => u.email === email)) {
                    return { error: 'Email already registered' };
                }
                
                const user = {
                    email,
                    password: btoa(password),
                    memberId: `MSL-F-${Math.floor(100000 + Math.random() * 900000)}`,
                    cryptoWallet: {
                        address: this.generateCryptoAddress(),
                        balance: 0
                    },
                    fiatWallet: {
                        account: `MAS_${Math.floor(1000000000 + Math.random() * 9000000000)}`,
                        balance: 0
                    },
                    notifications: [
                        {
                            message: 'Welcome to Masolites! Start by exploring the platform.',
                            timestamp: new Date().toISOString(),
                            read: false
                        }
                    ],
                    createdAt: new极 Date().toISOString(),
                    referralCode: Math.random().toString(36).substring(2, 10).toUpperCase(),
                    referredBy: referralCode
                };
                
                users.push(user);
                localStorage.setItem('users', JSON.stringify(users));
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                // Process referral
                if (referralCode) {
                    MLMSystem.processReferral(referralCode, user.email, 0);
                }
                
                return user;
            }
            
            static login(email, password) {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const user = users.find(u => u.email === email && u.password === btoa(password));
                
                if (user) {
                    localStorage.setItem('currentUser', JSON.stringify(user));
                    return user;
                }
                return null;
            }
            
            static getCurrentUser() {
                return JSON.parse(localStorage.getItem('currentUser'));
            }
            
            static logout() {
                localStorage.removeItem('currentUser');
            }
            
            static addNotification(user, message) {
                if (!user) return;
                
                user.notifications.unshift({
                    message,
                    timestamp: new Date().toISOString(),
                    read: false
                });
                
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const updatedUsers = users.map(u => u.email === user.email ? user : u);
                localStorage.setItem('users', JSON.stringify(updatedUsers));
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                return user;
            }
            
            static generateCryptoAddress() {
                const chars = '0123456789ABCDEF';
                let address = '0x';
                for (let i = 0; i < 40; i++) {
                    address += chars[Math.floor(Math.random() * 16)];
                }
                return address;
            }
        }

        // Save & Earn System
        class SaveEarn {
            static submitDeposit(amount, date, time) {
                const user = UserSystem.getCurrentUser();
                if (!user) return { error: 'Not authenticated' };
                
                const deposit = {
                    id: Date.now(),
                    userId: user.email,
                    amount,
                    date,
                    time,
                    status: 'pending',
                    timestamp: new Date().toISOString()
                };
                
                const deposits = JSON.parse(localStorage.getItem('deposits') || '[]');
                deposits.push(deposit);
                localStorage.setItem('deposits', JSON.stringify(deposits));
                
                // Record activity for admin
                const activity = JSON.parse(localStorage.getItem('activity') || '[]');
                activity.unshift({
                    userId: user.email,
                    action: 'Deposit Submitted',
                    details: `Manual deposit: ₦${amount}`,
                    timestamp: new Date().toISOString()
                });
                localStorage.setItem('activity', JSON.stringify(activity));
                
                // Add notification
                UserSystem.addNotification(user, `Manual deposit of ₦${amount} submitted. Waiting for admin approval.`);
                
                return deposit;
            }
            
            static processFlutterwave(amount) {
                const user = UserSystem.getCurrentUser();
                if (!user) return { error: 'Not authenticated' };
                
                // FLUTTERWAVE KEY LOCATION 1 (LINE 1078)
                const FLW_PUBLIC_KEY = "YOUR_FLUTTERWAVE_PUBLIC_KEY";
                
                FlutterwaveCheckout({
                    public_key: FLW_PUBLIC_KEY,
                    tx_ref: "DEPOSIT-" + Date.now(),
                    amount: amount,
                    currency: "NGN",
                    payment_options: "card, banktransfer, ussd",
                    customer: {
                        email: user.email,
                        name: "Masolites User"
                    },
                    callback: function(response) {
                        if (response.status === "successful") {
                            // Add to user balance
                            user.fiatWallet.balance += amount;
                            UserSystem.addNotification(user, `Flutterwave deposit of ₦${amount} successful!`);
                            
                            // Record activity
                            const activity = JSON.parse(localStorage.getItem('activity') || '[]');
                            activity.unshift({
                                userId: user.email,
                                action: 'Flutterwave Deposit',
                                details: `Amount: ₦${amount}`,
                                timestamp: new Date().toISOString()
                            });
                            localStorage.setItem('activity', JSON.stringify(activity));
                            
                            alert(`Successfully deposited ₦${amount}!`);
                        } else {
                            alert("Payment failed. Please try again.");
                        }
                    },
                    customizations: {
                        title: "Masolites Deposit",
                        description: "Fund your account",
                        logo: "https://masolites.com/logo.png"
                    }
                });
            }
        }

        // Mining System
        class MiningSystem {
            constructor() {
                this.miningInterval = null;
                this.minedAmount = 0;
                this.totalMined = 0;
                this.isMining = false;
                this.baseRate = 0.12 / (24 * 60 * 60 * 1000); // Tokens per ms
                this.lastMinuteUpdate = Date.now();
            }
            
            startMining() {
                if (this.isMining) return;
                
                const startTime = Date.now();
                this.lastMinuteUpdate = startTime;
                
                this.miningInterval = setInterval(() => {
                    const now = Date.now();
                    const elapsed = now - startTime;
                    this.minedAmount = elapsed * this.baseRate;
                    
                    if (now - this.lastMinuteUpdate >= 60000) {
                        this.totalMined += this.minedAmount;
                        document.getElementById('miningTotal').textContent = this.totalMined.toFixed(6) + ' MZLx';
                        this.lastMinuteUpdate = now;
                        localStorage.setItem('totalMined', this.totalMined.toString());
                        if (this.totalMined > 0) {
                            document.getElementById('claimButton').style.display = 'flex';
                        }
                    }
                    
                    document.getElementById('minedAmount').textContent = (this.minedAmount * 1000).toFixed(6) + ' MZLx/s';
                }, 50);
                
                this.isMining = true;
                document.getElementById('miningButton').innerHTML = '<i class="fas fa-stop"></i> STOP MINING';
                document.getElementById('miningButton').classList.add('mining-active');
            }
            
            stopMining() {
                if (!this.isMining) return;
                
                clearInterval(this.miningInterval);
                this.isMining = false;
                document.getElementById('miningButton').innerHTML = '<i class="fas fa-play"></i> START MINING';
                document.getElementById('miningButton').classList.remove('mining-active');
                localStorage.setItem('totalMined', this.totalMined.toString());
            }
            
            claimTokens() {
                const user = UserSystem.getCurrentUser();
                if (!user) {
                    alert('Please login first!');
                    return;
                }
                
                if (this.totalMined <= 0) {
                    alert('No tokens to claim!');
                    return;
                }
                
                user.cryptoWallet.balance += this.totalMined;
                UserSystem.addNotification(user, `Claimed ${this.totalMined.toFixed(6)} MZLx from mining!`);
                
                this.totalMined = 0;
                document.getElementById('miningTotal').textContent = '0.000000 MZLx';
                document.getElementById('claimButton').style.display = 'none';
                this.stopMining();
                
                alert(`Successfully claimed ${this.totalMined.toFixed(6)} MZLx!`);
            }
        }

        // MLM System
        class MLMSystem {
            static processReferral(referralCode, newUserId, amount) {
                const users = JSON.parse(localStorage.getItem('users') || '[]');
                const referrer = users.find(u => u.referralCode === referralCode);
                
                if (referrer) {
                    // 5% referral commission
                    const commission = amount * 0.05;
                    referrer.cryptoWallet.balance += commission;
                    
                    // Update user
                    localStorage.setItem('users', JSON.stringify(users));
                    
                    // Add notification
                    const message = `You earned ${commission.toFixed(6)} MZLx from referral!`;
                    UserSystem.addNotification(referrer, message);
                }
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize systems
            const miningSystem = new MiningSystem();
            
            // Load mined data if exists
            if (localStorage.getItem('totalMined')) {
                miningSystem.totalMined = parseFloat(localStorage.getItem('totalMined'));
                document.getElementById('miningTotal').textContent = miningSystem.totalMined.toFixed(6) + ' MZLx';
                if (miningSystem.totalMined > 0) {
                    document.getElementById('claimButton').style.display = 'flex';
                }
            }
            
            // Initialize countdown timer
            function initCountdown() {
                const endDate = new Date();
                endDate.setDate(endDate.getDate() + 120);
            
                function updateCountdown() {
                    const now = new Date();
                    const diff = endDate - now;
                    
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    
                    document.getElementById('days').textContent = days;
                    document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
                    document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                }
            
                setInterval(updateCountdown, 60000);
                updateCountdown();
            }
            initCountdown();
            
            // Auth Event Listeners
            document.getElementById('loginBtn').addEventListener('click', function() {
                document.getElementById('loginModal').style.display = 'flex';
            });
            
            document.getElementById('registerBtn').addEventListener('click', function() {
                document.getElementById('registerModal').style.display = 'flex';
            });
            
            document.getElementById('showRegister').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('registerModal').style.display = 'flex';
            });
            
            document.getElementById('confirmRegister').addEventListener('click', function() {
                const email = document.getElementById('registerEmail').value;
                const password = document.getElementById('registerPassword').value;
                const referralCode = document.getElementById('referralCode').value || null;
                
                const result = UserSystem.register(email, password, referralCode);
                if (result.error) {
                    alert(result.error);
                } else {
                    alert('Registration successful!');
                    document.getElementById('registerModal').style.display = 'none';
                    location.reload();
                }
            });
            
            document.getElementById('confirmLogin').addEventListener('click', function() {
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                
                const user = UserSystem.login(email, password);
                if (user) {
                    alert('Login successful!');
                    document.getElementById('loginModal').style.display = 'none';
                    location.reload();
                } else {
                    alert('Invalid email or password');
                }
            });
            
            // Mining Event Listeners
            document.getElementById('miningButton').addEventListener('click', function() {
                if (!UserSystem.getCurrentUser()) {
                    alert('Please login to start mining');
                    document.getElementById('loginModal').style.display = 'flex';
                    return;
                }
                
                if (miningSystem.isMining) {
                    miningSystem.stopMining();
                } else {
                    miningSystem.startMining();
                }
            });
            
            document.getElementById('claimButton').addEventListener('click', function() {
                miningSystem.claimTokens();
            });
            
            // Save & Earn
            document.getElementById('saveEarnBtn').addEventListener('click', function() {
                if (!UserSystem.getCurrentUser()) {
                    alert('Please login to use Save & Earn');
                    document.getElementById('loginModal').style.display = 'flex';
                    return;
                }
                document.getElementById('saveEarnModal').style.display = 'flex';
            });
            
            document.getElementById('submitDeposit').addEventListener('click', function() {
                const amount = parseFloat(document.getElementById('depositAmount').value);
                const date = document.getElementById('receiptDate').value;
                const time = document.getElementById('receiptTime').value;
                
                if (amount < 500 || amount > 2000000) {
                    alert('Amount must be between ₦500 and ₦2,000,000');
                    return;
                }
                
                if (!date || !time) {
                    alert('Please provide receipt date and time');
                    return;
                }
                
                const deposit = SaveEarn.submitDeposit(amount, date, time);
                if (deposit.error) {
                    alert(deposit.error);
                } else {
                    alert('Deposit submitted for approval!');
                    document.getElementById('saveEarnModal').style.display = 'none';
                }
            });
            
            // Flutterwave payment
            document.getElementById('processFlutterwave').addEventListener('click', function() {
                const amount = parseFloat(document.getElementById('fwAmount').value);
                if (amount < 500) {
                    alert('Minimum deposit is ₦500');
                    return;
                }
                SaveEarn.processFlutterwave(amount);
            });
            
            // Dashboard
            document.getElementById('platformWalletBtn').addEventListener('click', function() {
                const user = UserSystem.getCurrentUser();
                if (!user) {
                    alert('Please login to view wallet');
                    document.getElementById('loginModal').style.display = 'flex';
                    return;
                }
                
                document.getElementById('cryptoAddress').textContent = user.cryptoWallet.address;
                document.getElementById('cryptoBalance').textContent = user.cryptoWallet.balance.toFixed(6);
                document.getElementById('fiatAccount').textContent = user.fiatWallet.account;
                document.getElementById('fiatBalance').text极 content = user.fiatWallet.balance.toFixed(2);
                
                // Load notifications
                const notificationList = document.getElementById('notificationList');
                notificationList.innerHTML = '';
                user.notifications.forEach(notif => {
                    const item = document.createElement('div');
                    item.className = 'notification-item';
                    item.innerHTML = `
                        <p>${notif.message}</p>
                        <p class="notification-time">${new Date(notif.timestamp).toLocaleString()}</p>
                    `;
                    notificationList.appendChild(item);
                });
                
                document.getElementById('dashboardModal').style.display = 'flex';
            });
            
            // Voting
            document.getElementById('voteBtn').addEventListener('click', function() {
                const user = UserSystem.getCurrentUser();
                if (!user) {
                    alert('Please login to vote');
                    document.getElementById('loginModal').style.display = 'flex';
                    return;
                }
                
                // Check voting hours (6pm - 11:30pm WAT)
                const now = new Date();
                const hours = now.getHours();
                const canVote = hours >= 18 && hours < 23.5;
                
                if (!canVote) {
                    document.getElementById('votingForm').innerHTML = `
                        <p class="welcome-message">Voting is only available between 6pm - 11:30pm WAT</p>
                    `;
                } else {
                    document.getElementById('votingForm').innerHTML = `
                        <div class="vote-form">
                            <div class="form-group">
                                <label>New Token Price ($)</label>
                                <input type="number" id="newPrice" min="0.001" step="0.001" value="0.001">
                            </div>
                            <button class="cta-button" id="submitVote">
                                <i class="fas fa-vote-yea"></i> Submit Vote
                            </button>
                        </div>
                    `;
                    
                    // Add event listener to the new button
                    document.getElementById('submitVote').addEventListener('click', function() {
                        const newPrice = parseFloat(document.getElementById('newPrice').value);
                        if (newPrice < 0.001) {
                            alert('Minimum price is $0.001');
                            return;
                        }
                        
                        // Update token price
                        TOKENOMICS.currentPrice = newPrice;
                        alert(`Vote submitted! New price: $${newPrice.toFixed(3)}`);
                        document.getElementById('voteModal').style.display = 'none';
                    });
                }
                
                document.getElementById('voteModal').style.display = 'flex';
            });
            
            // Buy MAZOL
            document.getElementById('buyButton').addEventListener('click', function() {
                const user = UserSystem.getCurrentUser();
                if (!user) {
                    alert('Please login to buy tokens');
                    document.getElementById('loginModal').style.display = 'flex';
                    return;
                }
                
                document.getElementById('buyModal').style.display = 'flex';
            });
            
            // Buy options
            document.getElementById('bankOption').addEventListener('click', function() {
                alert('Bank transfer details will be displayed');
            });
            
            document.getElementById('usdtOption').addEventListener('click', function() {
                alert('USDT wallet address will be displayed');
            });
            
            document.getElementById('flutterOption').addEventListener('click', function() {
                const user = UserSystem.getCurrentUser();
                if (!user) return;
                
                // FLUTTERWAVE KEY LOCATION 2 (LINE 1667)
                const FLW_PUBLIC_KEY = "YOUR_FLUTTERWAVE_PUBLIC_KEY";
                
                FlutterwaveCheckout({
                    public_key: FLW_PUBLIC_KEY,
                    tx_ref: "TOKENPURCHASE-" + Date.now(),
                    amount: 1000, // Sample amount
                    currency: "NGN",
                    payment_options: "card, banktransfer, ussd",
                    customer: {
                        email: user.email,
                        name: "Masolites User"
                    },
                    callback: function(response) {
                        if (response.status === "successful") {
                            // Add tokens to user
                            const tokensPurchased = 1000 / TOKENOMICS.ngnPrice;
                            user.cryptoWallet.balance += tokensPurchased;
                            UserSystem.addNotification(user, `Purchased ${tokensPurchased.toFixed(2)} MZLx!`);
                            alert(`Successfully purchased ${tokensPurchased.toFixed(2)} MZLx!`);
                        } else {
                            alert("Payment failed. Please try again.");
                        }
                    },
                    customizations: {
                        title: "MAZOL Token Purchase",
                        description: "Buying MAZOL tokens",
                        logo: "https://masolites.com/logo.png"
                    }
                });
            });
            
            // Admin button
            document.getElementById('adminBtn').addEventListener('click', function() {
                window.location.href = 'admin.html';
            });
            
            // Logout
            document.getElementById('logoutBtn').addEventListener('click', function() {
                UserSystem.logout();
                location.reload();
            });
            
            // Profile update
            document.getElementById('updateProfile').addEventListener('click', function() {
                const user = UserSystem.getCurrentUser();
                if (!user) return;
                
                user.fullName = document.getElementById('userFullName').value;
                user.phone = document.getElementById('userPhone').value;
                
                // Update user
                const users = JSON.parse(localStorage.getItem('users') || []);
                const updatedUsers = users.map(u => u.email === user.email ? user : u);
                localStorage.setItem('users', JSON.stringify(updatedUsers));
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                alert('Profile updated successfully!');
            });
            
            // Modal close buttons
            document.querySelectorAll('.modal-close').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.style.display = 'none';
                    });
                });
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', function(e) {
                if (e.target.classList.contains('modal')) {
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.style.display = 'none';
                    });
                }
            });
            
            // Tab switching
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tab = this.dataset.tab;
                    
                    // Update active tab
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show correct content
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tab}Tab`).classList.add('active');
                });
            });
            
            // Check if user is logged in
            const user = UserSystem.getCurrentUser();
            if (user) {
                document.getElementById('loginBtn').style.display = 'none';
                document.getElementById('registerBtn').style.display = 'none';
                document.getElementById('logoutBtn').style.display = 'flex';
                document.getElementById('memberId').textContent = user.memberId;
                document.getElementById('memberBadge').innerHTML = `<i class="fas fa-gift"></i> ${user.memberId}`;
            }
        });
    </script>
</body>
</html>
